<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Туториал</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        h1, h2 {
            font-family: 'Playfair Display', serif;
            text-align: center;
        }
        
        a {
            color: #1E40AF; /* синий цвет */
        }
    
    </style>
</head>
<body class="bg-gray-100 text-gray-900">
    <div class="max-w-5xl mx-auto p-6">
        <header class="text-center my-8">
            <h1 class="text-4xl font-bold">Об анимации вместе с Рикошетом!</h1>
            <p class="text-lg text-gray-600">Микротуториал по технической анимации для самых маленьких.</p>
        </header>
        
        <section class="space-y-6">
            <article class="bg-white p-6 rounded-lg shadow">
                <video class="mx-auto" controls autoplay loop>
                    <source src="images/slowmo.webm" type="video/mp4">
                    
                  </video>
                <h2 class="text-2xl font-semibold">Об экспорте анимации.</h2>
                <p class="mt-2">Перед нами невероятный и интересный мир компьютерной анимации в программе Spine. Здесь мы кратко рассмотрим, что делать, если аниматор передал файлы проекта, ушёл спать, а объяснить, что с ними делать, не потрудился.</p>
                <ul class="list-disc list-inside mt-2 text-gray-700">
                    <li>Запускаем проект, и видим такое: <img src="images/open.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto"> Если нажать на Setup, слева сверху, то можно просмотреть анимации, которые собраны в проекте, список их по умолчанию можно найти в дереве проекта cправа, но углубляться не будем, мы здесь за другим &mdash; жмём слева сверху на надпись-логотип spine, затем на export: <img src="images/world.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto">
                    <li>Нам открывается интересное окно со списком всех возможных вариантов экспорта. Наш выбор - JSON. Значительно реже мы можем выбрать Binary, принципы настроек примерно одинаковы. В окне Json мы можем выбрать путь сохранения экспорта, версию экспорта (в последних версиях спайна стала доступна такая функция), и внизу галочку Open after export. Сейчас мы должны нажать на кнопку <b>Pack Settings</b>:<img src="images/json.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto"></li>    
                    <li>Удивительной красоты меню открылось перед нами. Страшная и непонятная настройка упаковки атласов. В ней много опций, но мы пройдёмся по основным, тем, которые могут быть нам полезны и интересны в зависимости от задачи. Их я насчитал целых восемь:<img src="images/packer.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto">
                        <ol class="list-decimal list-inside ml-5 mb-4 mt-4">
                        <li><b>MaxWidth/MaxHeight</b> &mdash; мы задаём максимальные размеры атласа, атлас нужно стараться делать не больше 4096x4096, а ещё лучше, не превышать 2048х2048. </li>
                        <li><b>Power of two</b> &mdash; по умолчанию нужно включать всегда, и по хорошему, вообще не трогать её. Отвечает за то, чтобы атласы были с размерами сторон кратны двойке в какой-то степени (16, 32, 64, 128, 256, 512, etc).</li>
                        <li><b>Square</b> &mdash; делает атлас квадратным. Иногда для экономии места, в целях агрессивной оптимизации проекта, можно отключить, и атласы на выходе будут получаться прямоугольными, иногда с непредсказуемыми размерами, вроде 1024x64. Атласы можно пробовать оставлять такими, когда используются длинные вытянутые детали в анимации.</li>
                        <li><b>Filter min/Filter mag</b> &mdash; эта настройка редко изменяется, но если в проекте на динамических анимациях, особенно при скейлах всего скелета или частей тела, появляются шакальные пиксели или артефакты спрайтов, то можно проверить, не стоит ли nearest, и переключить её на Linear. </li>
                        <li><b>Scale</b> &mdash; если спрайты у нас соответствуют HD графике, а на выходе персонаж должен быть размера в 4 меньше, то мы можем выставить scale 0.25, тогда все спрайты запакуются в атлас в этом скейле. В таком случае, неплохо было бы главную кость под рутом в проекте поскейлить тоже, но это зависит от того, как организован проект и есть ли такая кость. Root трогать нельзя.</li>
                        <li><b>Premultiply alpha</b> &mdash; если у нас есть объекты с альфой/полупрозрачностью, без этой галочки они будут некорректно отображаться в проекте. </li>
                        <li><b>Bleed</b> &mdash; некоторые спрайты без этой галочки могут на границах-пересечениях иметь артефакты ввиде затемнённых краёв, если такое случается, прожимаем галочку</li>
                        <li><b>Atlas extension</b> &mdash; при работе в юнити и некоторых других движках следует прописать .txt в конце расширения, если её нет. Это избавит от ошибки импорта в юнити, и лишней мороки и гаданий. </li>
                        </ol> </li>
                    <li>C настройками разобрались, жмём ок в окне пакера, и export в окне Json, и переходим к следующему пункту.</li>
                </ul> 
                <img src="example2.jpg" alt="Пример" class="mt-4 rounded-lg shadow">
            </article>
           
           
            <article class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-2xl font-semibold mx-auto block">О том, что делать после экспорта</h2>
                
                <p class="mt-2">Если ты пропустил первый раздел, посвящённый экспорту, и впервые сталкиваешься с тем, чтобы вставить анимацию из Spine в проект, не знаешь, что делать, то ты в нужном месте и на верном пути.</p><ul class="list-disc list-inside mt-2 text-gray-700">
                    <li>Для начала нам нужно узнать, какую версию спайна используют в анимации. Аниматор прислал zip архив с экспортом. Распакуем его в отдельную папку. Внутри него лежит три файла: <img src="images/files.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto">
                        
                        <ul class="list-circle list-inside ml-5 mb-4 mt-4">
                            <li>Первый файл <b>Scene.atlas.txt</b> &mdash; это файл в котором лежит информация о том, какие спрайты на каких координатах запакованы в атлас анимации.</li>
                            <li>Второй файл <b>Scene.json</b> &mdash; это файл с информацией об анимации, здесь хранится буквально вся информация об анимации проекта.</li>
                            <li>Третий файл <b>Scene.png</b> &mdash; это файл с запечёнными в один атлас спрайтами.</li>
                        </ul> 
                        Есть два варианта узнать версию спайна: спросить напрямую или посмотреть в этих трёх файлах. Аниматор наанимировался и спит, заглянем в файл Scene.Json: открываем его в каком-нибудь редакторе кода или текста. В самом начале видим строчку: <img src="images/export.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto">
                        Это то, что нам нужно. Наша версия спайна: 4.2</li>
                    <li>Тернистый путь завёл нас на сайт великих и прекрасных разработчиков спайна <a class="text-blue-500 hover:text-blue-700" href="https://esotericsoftware.com/spine-runtimes">Esoteric Software</a> в раздел рантаймов (рантайм это такой набор классов, инструкций, методов и прочих программистких терминов, которые помогают одной программе использовать результаты деятельности другой программы). Находим и <a class="text-blue-500 hover:text-blue-700" href="http://esotericsoftware.com/spine-unity-download/">качаем</a> нужный рантайм под наш движок юнити. <a   class="text-blue-500 hover:text-blue-700" href="https://esotericsoftware.com/files/runtimes/unity/spine-unity-4.2-2025-03-24.unitypackage">Прямая ссылка на пэкэдж версии 4.2 (для очень ленивых)</a>.</li>
                    <li>Пока скачивается пэкэдж, запускаем юнити и идём пить чай.</li>
                </ul>
                <video class="mx-auto" controls autoplay loop>
                    <source src="images/click.webm" type="video/mp4">
            </article>

            <article class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-2xl font-semibold">Об импорте анимации.</h2>
                <p class="mt-2">Юнити открыт, пэкэдж скачан, архив от аниматора распакован. Займёмся доготовкой юнити и установкой пэкэджа.</p>
                <ul class="list-disc list-inside mt-2 text-gray-700">
                    <li>Нам безумно повезло, и при открытой юнити нужно два раза кликнуть по пэкэджу, и юнити спросит: <img src="images/package.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto">
                        Cмело жмём import. Уже в недалёком будущем, когда мы будем крутыми импортёрами спайн-анимаций в юнити-проекты, мы сделаем ход конём и будем убирать некоторые галочки с ненужных туториалов и примеров в рантайме. Но это будет потом.  
                    <li>Остаётся дело за малым. Создаём папку для будущих имортов (у меня это Animation/Characters). <img src="images/unity.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto"> Перетаскиваем файлы экспорта (json, atlas.txt, png) в папку. Логично было бы создать папку Ricochet (для каждого персонажа из спайна лучше создавать свою папку, в рамках общего порядка) или Scene (по названию файлов), но мы пойдём коротким путём, и закинем её в Characters. Юнити, при установленном рантайме автоматически создаст несколько новых файлов (было три, стало шесть, магия, не иначе): <img src="images/ricochet.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto"> Если по какой-то причине, файлы не создались, или появилась ошибка, проверь, не забыл ли аниматор дописать расширение .txt к файлу .atlas. Это распространнённая ошибка на начальных порах, об этом упоминалось в первом пункте об экспорте из спайна.</li>    
                    <li>Нам стал доступен доступен файл с постфиксом _SkeletonData. Перетащим его на рабочую поверхность юнити, и выберем один из трёх вариантов (для теста возьмём верхний): <img src="images/skeleton.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto">
                    Да, в целях небольшого разъяснения. Animation берём, если хотим использовать аниматор кодом, который идёт вместе с рантаймом, Graphic(UI) &mdash; если вставляем в канвас, а Mecanim &mdash; если будем прикручивать анимации в родной аниматор от юнити, дав возможность аниматору наделать страшных делов с нодами стейтов.</li>
                    <li>После того, как перетащили сцену на рабочую поверхность, нас может ждать сюрприз. В данном случае лучи с альфой стали белыми: <img src="images/alpha.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto">Это одна из распространённых ошибок экспорта-импорта, прямая отсылка к настройкам экспорту, пункту 6, внимательный читатель вспомнит, что речь идёт о настройке Premultiply Alpha. При экспорте не прожали галочку с этой настройкой, и у нас есть два пути. Или сделать реэкспорт, если доступны файлы проекта, или среди файлов импорта материал с постфиксом _Material, и прожать в инспекторе Straigh Alpha TextureЖ <img src="images/sat.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto"> что подарит нам вот такой вариант изображения: <img src="images/final.png" alt="файлы" class="mt-4 mb-4 rounded-lg shadow mx-auto"> но лучше, конечно, сделать реэкспорт.</li> 
                    <li>В заключении хочу добавить, что анимации можно посмотреть в том же инспекторе, но только у файла _SkeletonData. Там же можно посмотреть скины, сгенерировать аниматор для меканима, настроить блендмоды, но об этом всём как-нибудь в другой раз. </li>   
                </ul> 
                <video class="mx-auto" controls autoplay loop>
                    <source src="images/duck.webm" type="video/mp4">
            </article>
        </section>

        <footer class="text-center my-12 text-gray-500">
            &copy; 2025 MRLK
        </footer>
    </div>
</body>
</html>
